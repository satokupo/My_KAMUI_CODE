# Relumeプロジェクト初期セットアップフロー

## 概要
RelumeからダウンロードしたワイヤーフレームHTMLを、デザインブラッシュアップ可能な状態に自動セットアップするフロー。

---

## 全体フロー

### 1. ユーザー手動作業
1. Relumeからプロジェクトzipファイルをダウンロード
2. 任意のディレクトリに解凍（例: `Relume/2025-10-08_satokupo-design-test/`）

**注意**: Relumeから出力されるディレクトリ構造は以下の通り:
- ディレクトリ名: 日本語名またはスペース含み（例: `ホーム/`, `初めての方へ/`, `Layout 324/`）
- 各ディレクトリ内: `index.html`が既に配置済み

### 2. ページ順序確認と連番付与（対話形式）

AIがページディレクトリ一覧を表示し、順序を確認後、連番を付与します。

#### フロー

##### a) ページリスト表示
AIが解凍されたディレクトリ内のページ一覧を番号付きで表示します。

```
AI: 以下のページが見つかりました:
  1. ホーム
  2. 初めての方へ
  3. サービス紹介
  ... (以下略)

この順番でディレクトリに連番を付与していいですか？
```

##### b) ユーザー確認

- **OK/はい/そのまま**: そのままの順序で連番付与
- **順序指定**: 例「1,3,2,4,5,6,7」のように番号で順序を指定
- **やり直し**: ページリストを再表示

##### c) 連番付与実行

AIが`rename.py`を使用してディレクトリ名に連番を付与します。

```bash
# 例: rename.pyのJSONマッピング機能を使用
.venv/Scripts/python.exe docs/helper/rename.py \
  --root-dir "s:/MyProjects/KAMUI_CODE/Relume/2025-10-08_satokupo-design-test/copy-of-ホームページ作成サービス" \
  --mapping '{"ホーム":"01_ホーム","初めての方へ":"02_初めての方へ",...}'
```

**結果例:**
```
✅ renamed: ホーム -> 01_ホーム
✅ renamed: 初めての方へ -> 02_初めての方へ
✅ renamed: サービス紹介 -> 03_サービス紹介
...
```

### 3. 各ページ構成の聞き取り（対話形式）

AIが各ページのセクション構成をユーザーから聞き取ります。

#### 聞き取りフロー

##### a) セクション構成の確認
連番付与されたページごとに、セクション構成を聞き取ります。

##### b) 各ページの構成を聞き取り

**フロー:**
1. AIがHTMLを読み込み、セクション数をカウント（ヘッダー・フッター除外）
2. セクション数をユーザーに伝える
3. ユーザーがその数に合わせて、上から順にセクション名を回答（ヘッダー・フッター除く）
4. 必要に応じてユーザーがコードを確認して回答

**例（01_ホームページの場合）:**
```
AI: 「01_ホーム」ページのセクション構成を教えてください。
    HTML内に 5個のセクション が確認されています（ヘッダー・フッターを除く）。
    ヘッダーとフッターを除いて、上から順に5個のセクション名を教えてください。

User: 上から、ヒーローセクション、サービス特徴A、サービス特徴B、料金表、お問い合わせ

AI: 了解しました。以下のID名で設定します:
  1. hero-section
  2. service-features-a
  3. service-features-b
  4. pricing-table
  5. contact

  次のページに進みます。

AI: 「02_料金」ページのセクション構成を教えてください。
    HTML内に 3個のセクション が確認されています（ヘッダー・フッターを除く）...
```

**注意:**
- ヘッダーとフッターはID付与対象外（自動でタグ化される）
- 一時確認は不要（ユーザーが問題あれば指摘する前提）
- すぐに次のページの聞き取りに進む
- ユーザーはビジュアルを見て判断するため、コード上のセクション数と認識が異なる場合があります
- AIが先にセクション数を伝えることで、ユーザーがコードを確認して正確に回答できます

##### c) 全ページ分の聞き取り完了

全ページの聞き取りが完了したら、AIは設定内容を一覧表示して最終確認します。

```
AI: 全ページの構成が確定しました:

【01_ホーム】: hero-section, service-features-a, service-features-b, pricing-table, contact
【02_料金】: pricing-hero, plan-comparison, faq
... (以下略)

※ヘッダー・フッターは自動でタグ化されるため、上記には含まれていません

この内容でセットアップを開始してよろしいですか？
```

### 4. Pythonスクリプト実行（引数でセクション情報を渡す）

聞き取りで確定したセクション構成を、コマンドライン引数でスクリプトに渡します。

#### 基本形式
```bash
.venv/Scripts/python.exe docs/helper/setup_relume_project.py \
  --page-dir "<ページディレクトリパス>" \
  --sections "section1,section2,section3,..."
```

#### 実行例（1ページずつ）
```bash
# 01_ホームページ（ヘッダー・フッター除く）
.venv/Scripts/python.exe docs/helper/setup_relume_project.py \
  --page-dir "s:/MyProjects/KAMUI_CODE/Relume/2025-10-08_satokupo-design-test/copy-of-ホームページ作成サービス/01_ホーム" \
  --sections "hero-section,service-features,pricing-table,contact"

# 02_料金ページ（ヘッダー・フッター除く）
.venv/Scripts/python.exe docs/helper/setup_relume_project.py \
  --page-dir "s:/MyProjects/KAMUI_CODE/Relume/2025-10-08_satokupo-design-test/copy-of-ホームページ作成サービス/02_料金" \
  --sections "pricing-hero,plan-comparison,faq"
```

#### 複数ページ一括実行（オプション）
```bash
.venv/Scripts/python.exe docs/helper/setup_relume_project.py \
  --root-dir "s:/MyProjects/KAMUI_CODE/Relume/2025-10-08_satokupo-design-test/copy-of-ホームページ作成サービス" \
  --page "01_ホーム:hero-section,service-features,pricing-table,contact" \
  --page "02_料金:pricing-hero,plan-comparison,faq" \
  --page "03_サービス紹介:service-hero,service-list,testimonials"
```

**注意**: セクション名リストにはヘッダー・フッターを含めません

### 5. スクリプトの自動処理内容

#### 5-1. 各ページのセットアップ
各ページディレクトリに対して以下を実行:

##### a) HTML基本タグの付与
元のコンテンツを特定のHTMLテンプレートでラップ(setup_relume_project.py)

##### b) セクションへのユニークID付与
- 最初の`<section>`を`<header>`でラップ
- 最後の`<footer>`タグを特定
- `#content-area`内の`<section>`のみを検出（header/footer除外）
- 引数で渡されたセクション名リストを順番に適用
- 各セクションに意味のあるIDを付与
  - 例: `hero-section`, `service-features`, `contact`

##### b-2) セクション数検証
- HTML内の実際のセクション数（header/footer除く）と、引数で渡されたセクション名の数を比較
- 不一致の場合はエラーメッセージを表示して処理を中断
  ```
  ERROR: セクション数が一致しません
    引数で指定: 4個 (hero-section, service-features, pricing-table, contact)
    HTML内の実際: 5個（header/footer除く）

  各セクションの概要:
    [1] <section class="..."> ... (hero相当)
    [2] <section class="..."> ... (features相当？)
    [3] <section class="..."> ... (features続き？)
    [4] <section class="..."> ... (pricing相当)
    [5] <section class="..."> ... (contact相当)

  上記を確認の上、正しいセクション名リストを指定してください。
  ```

##### c) テンプレート構造のコピー
`docs/helper/setup_templates/`から以下の構造を丸ごとコピー:
```
<ページディレクトリ>/
├── assets/
│   ├── js/
│   │   ├── main.js          # features/自動読込コード付き
│   │   └── features/
│   ├── style/
│   │   └── base.css         # CSSネストルール案内コメント付き
│   │   └── custom.css       # CSSネストルール案内コメント付き
│   └── images/
├── screenshots/
├── temp/
└── docs/
    └── ai-workbench/
```

※ 既存のファイル・ディレクトリは上書きせず保持

##### d) 修正されたHTMLの保存
- 上記すべての修正を適用したindex.htmlを上書き保存

#### 5-2. 実行結果レポート出力
コンソールに以下を表示:
- コピーされたディレクトリ・ファイル一覧
- 各ページで付与されたセクションID一覧

---

## セットアップ後の作業フロー

### 6. デザインブラッシュアップ開始
各ページの`assets/style/custom.css`にスタイルを追加していく。

#### CSS編集ルール
- すべての追加スタイルは`custom.css`にセクション単位で記述
- **必ずネストルールを使用**（入れ子構造）
- 各セクションは最上位のID配下にすべて閉じ込める

例:
```css
/* assets/style/custom.css */
#section-hero {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

  .hero-title {
    font-size: 3rem;
    font-weight: bold;
  }

  .hero-button {
    background: white;
    color: #667eea;
    padding: 1rem 2rem;
  }
}

#section-features {
  padding: 4rem 0;

  .feature-card {
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 2rem;
  }
}
```

#### JS編集ルール
- `assets/js/main.js`がエントリーポイント（自動読込方式）
- 機能は`assets/js/features/`に配置するだけで自動認識
- 各機能は`export function init()`を実装
  - 例: `features/carousel.js`, `features/modal.js`
- `main.js`が`import.meta.glob()`で自動読込・実行



**main.jsの実装**:
```javascript
const modules = import.meta.glob('./features/*.js', { eager: true });

document.addEventListener('DOMContentLoaded', () => {
  Object.values(modules).forEach(module => {
    if (module.init && typeof module.init === 'function') {
      module.init();
    }
  });
});
```

**features/の機能モジュール例**:
```javascript
// assets/js/features/carousel.js
export function init() {
  console.log('Carousel initialized');
  // カルーセル機能の実装
}
```

---

## 注意事項

### 冪等性の確保
- スクリプトは複数回実行しても安全
- 既にHTML基本タグが存在する場合はスキップ
- 既存ディレクトリ・ファイルは上書きしない

### 文字コード
- すべてのファイルはUTF-8で処理
- Pythonスクリプトも明示的にUTF-8を指定
- 日本語メッセージも文字化けしないよう処理

### Git管理
- プロジェクトはGit管理されているため、破壊的変更も問題なし

---

## 今後の拡張可能性

- 複数ページ一括処理オプション
- セクションID命名規則のカスタマイズ
- テンプレートのカスタマイズ（meta tag追加等）
- 画像生成AI連携による自動アセット生成
